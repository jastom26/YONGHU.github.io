<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>枝枝的歌单</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">枝枝的歌单</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarContent">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">首页</a></li>
                    <li class="nav-item"><a class="nav-link active" href="songs.html">歌曲列表</a></li>
                </ul>
                <div class="d-flex">
                    <span class="badge animate-pulse me-2" id="liveStatus">
                        </span>
                    <button class="btn btn-outline-light" id="randomButton" disabled>
                        <i class="bi bi-shuffle"></i> 随机点歌
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <main class="container my-4">
        <div class="text-center mb-4">
            <h1 class="display-5">枝枝的歌单</h1>
            <p class="lead">点击歌曲复制点歌口令</p>
        </div>

        <div class="row mb-3">
            <div class="col-md-6 mb-2">
                <input type="text" class="form-control" id="searchInput" placeholder="搜索歌名、歌手、风格、备注..." disabled>
            </div>
            <div class="col-md-6 mb-2">
                <select class="form-select" id="genreFilter" disabled>
                    <option value="">所有风格</option>
                </select>
            </div>
        </div>

        <div id="loading" class="text-center my-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-2">正在加载歌单...</p>
        </div>

        <div class="table-responsive">
            <table class="table table-dark table-hover" id="songTable" style="display: none;">
                <thead>
                    <tr>
                        <th>歌名</th>
                        <th>歌手</th>
                        <th>风格</th>
                        <th>备注</th>
                    </tr>
                </thead>
                <tbody>
                    </tbody>
            </table>
        </div>

        <div class="card mt-4 bg-dark text-white">
            <div class="card-header">
                最近点歌 (<span id="recent-count">0</span>)
                <button class="btn btn-sm btn-outline-light float-end" onclick="localStorage.removeItem('recentSongs'); displayRecentSongs(); showToast('最近点歌记录已清空');">清空</button>
            </div>
            <div class="card-body" id="recentSongs">
                </div>
        </div>
    </main>

    <footer class="footer mt-auto py-3 bg-dark text-white-50 text-center">
        <div class="container">
            <small>&copy; 2024 枝枝的歌单. All rights reserved.</small>
        </div>
    </footer>

    <div id="customToast" class="custom-toast"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // 更新后的歌单数据（从CSV解析而来）
        const allSongs = [
    {"歌名": "11", "歌手": "队长", "风格": "嘻哈", "备注": ""},
    {"歌名": "88080", "歌手": "仙某某", "风格": "古风", "备注": ""},
    {"歌名": "Simon", "歌手": "周菲戈", "风格": "流行", "备注": ""},
    {"歌名": "一吻天荒", "歌手": "胡歌", "风格": "古风", "备注": ""},
    {"歌名": "一念众生", "歌手": "冬子", "风格": "古风", "备注": ""},
    {"歌名": "一样的月光", "歌手": "徐佳莹", "风格": "流行", "备注": ""},
    {"歌名": "一梦惊鸿", "歌手": "黄诗扶", "风格": "古风", "备注": ""},
    {"歌名": "一生等你", "歌手": "屈楚萧", "风格": "流行", "备注": ""},
    {"歌名": "万梦星", "歌手": "黄诗扶", "风格": "古风", "备注": ""},
    {"歌名": "万疆", "歌手": "李玉刚", "风格": "流行", "备注": "民族高音"},
    {"歌名": "万象霜天", "歌手": "赤羽", "风格": "古风", "备注": "古风高音"},
    {"歌名": "三拜红尘凉", "歌手": "尹昔眠", "风格": "古风", "备注": ""},
    {"歌名": "三行情诗", "歌手": "黄诗扶", "风格": "古风", "备注": ""},
    {"歌名": "上弦之月", "歌手": "萧忆情Alex", "风格": "古风", "备注": ""},
    {"歌名": "不为谁而作的歌", "歌手": "林俊杰", "风格": "流行", "备注": ""},
    {"歌名": "不枉", "歌手": "宋亚轩", "风格": "流行", "备注": ""},
    {"歌名": "不破", "歌手": "阿肆", "风格": "流行", "备注": ""},
    {"歌名": "不老梦", "歌手": "银临", "风格": "古风", "备注": ""},
    {"歌名": "不觉秋色浅", "歌手": "熙云XYUN", "风格": "古风", "备注": ""},
    {"歌名": "不谓侠", "歌手": "萧忆情Alex", "风格": "古风", "备注": ""},
    {"歌名": "世末歌者", "歌手": "乐正绫", "风格": "古风", "备注": ""},
    {"歌名": "东京不太热", "歌手": "封茗囧菌", "风格": "古风", "备注": ""},
    {"歌名": "东北民谣", "歌手": "毛不易", "风格": "民谣", "备注": ""},
    {"歌名": "东风志", "歌手": "Aki阿杰", "风格": "古风", "备注": ""},
    {"歌名": "两相欢", "歌手": "音阙诗听", "风格": "古风", "备注": ""},
    {"歌名": "丹青客", "歌手": "HITA", "风格": "古风", "备注": ""},
    {"歌名": "九九八十一", "歌手": "双笙（陈元汐）", "风格": "古风", "备注": "古风高音"},
    {"歌名": "九张机", "歌手": "叶炫清", "风格": "古风", "备注": ""},
    {"歌名": "也罢", "歌手": "鲁向卉", "风格": "流行", "备注": ""},
    {"歌名": "予君书", "歌手": "阿YueYue", "风格": "古风", "备注": ""},
    {"歌名": "云与海", "歌手": "啵啵叽", "风格": "流行", "备注": ""},
    {"歌名": "云水谣", "歌手": "伦桑", "风格": "古风", "备注": ""},
    {"歌名": "云裳羽衣曲", "歌手": "自由诗工作室", "风格": "古风", "备注": ""},
    {"歌名": "人是", "歌手": "周深", "风格": "流行", "备注": ""},
    {"歌名": "人间不值得", "歌手": "古风", "风格": "古风", "备注": ""},
    {"歌名": "人鱼之歌", "歌手": "朵莉亚", "风格": "古风", "备注": "流行高音"},
    {"歌名": "人鱼的眼泪", "歌手": "EXO", "风格": "古风", "备注": ""},
    {"歌名": "今夜有雨", "歌手": "蒋一帆", "风格": "古风", "备注": ""},
    {"歌名": "今日无事", "歌手": "黄诗扶", "风格": "古风", "备注": ""},
    {"歌名": "伶人", "歌手": "排骨教主", "风格": "古风", "备注": ""},
    {"歌名": "何以歌", "歌手": "Aki阿杰", "风格": "古风", "备注": ""},
    {"歌名": "何必诗债换酒钱", "歌手": "Winky诗", "风格": "古风", "备注": ""},
    {"歌名": "何者", "歌手": "谭晶", "风格": "古风", "备注": "流行高音"},
    {"歌名": "余生缘", "歌手": "世界之外", "风格": "流行", "备注": ""},
    {"歌名": "你吻了我这件小事", "歌手": "孟慧圆", "风格": "古风", "备注": ""},
    {"歌名": "你的目光", "歌手": "Alec Benjamin", "风格": "古风", "备注": ""},
    {"歌名": "修炼爱情", "歌手": "林俊杰", "风格": "流行", "备注": ""},
    {"歌名": "借月", "歌手": "王天阳", "风格": "古风", "备注": ""},
    {"歌名": "借梦", "歌手": "Anna hisbbuR", "风格": "古风", "备注": ""},
    {"歌名": "借过", "歌手": "Uu", "风格": "流行", "备注": ""},
    {"歌名": "像风一样", "歌手": "薛之谦", "风格": "古风", "备注": ""},
    {"歌名": "光亮", "歌手": "周深", "风格": "流行", "备注": ""},
    {"歌名": "入凡", "歌手": "陈亦洺", "风格": "古风", "备注": ""},
    {"歌名": "兰亭序", "歌手": "王丹", "风格": "古风", "备注": ""},
    {"歌名": "兰花花儿", "歌手": "谭维维", "风格": "古风", "备注": "流行高音"},
    {"歌名": "关键词", "歌手": "林俊杰", "风格": "流行", "备注": ""},
    {"歌名": "再见", "歌手": "张震岳", "风格": "摇滚", "备注": ""},
    {"歌名": "凄美地", "歌手": "郭顶", "风格": "流行", "备注": ""},
    {"歌名": "凝眸", "歌手": "小迪String", "风格": "流行", "备注": ""},
    {"歌名": "别找我麻烦", "歌手": "蔡健雅", "风格": "古风", "备注": ""},
    {"歌名": "到此为止", "歌手": "徐佳莹", "风格": "古风", "备注": ""},
    {"歌名": "剑落杯中月", "歌手": "李常超 (Lao乾妈)", "风格": "古风", "备注": ""},
    {"歌名": "千年", "歌手": "赖仔Morris", "风格": "流行", "备注": ""},
    {"歌名": "千梦", "歌手": "Aki阿杰", "风格": "古风", "备注": ""},
    {"歌名": "千灯愿", "歌手": "弦森", "风格": "古风", "备注": ""},
    {"歌名": "千秋迭梦", "歌手": "镜予歌", "风格": "古风", "备注": ""},
    {"歌名": "半壶纱", "歌手": "刘珂矣", "风格": "古风", "备注": ""},
    {"歌名": "华阴老腔一声喊", "歌手": "谭维维", "风格": "古风", "备注": "流行高音"},
    {"歌名": "卷珠帘", "歌手": "霍尊", "风格": "古风", "备注": ""},
    {"歌名": "去也", "歌手": "青龙捕快", "风格": "古风", "备注": ""},
    {"歌名": "叙世", "歌手": "陈贰柒", "风格": "古风", "备注": ""},
    {"歌名": "古龙群侠传", "歌手": "河图", "风格": "古风", "备注": ""},
    {"歌名": "只对你有感觉", "歌手": "林俊杰", "风格": "古风", "备注": ""},
    {"歌名": "君临天下", "歌手": "国风堂", "风格": "古风", "备注": ""},
    {"歌名": "听", "歌手": "方大同", "风格": "流行", "备注": ""},
    {"歌名": "吹梦到西洲", "歌手": "恋恋故人难", "风格": "古风", "备注": ""},
    {"歌名": "命运", "歌手": "家家", "风格": "流行", "备注": ""},
    {"歌名": "喂", "歌手": "单依纯", "风格": "流行", "备注": ""},
    {"歌名": "四万秋", "歌手": "国风堂", "风格": "古风", "备注": ""},
    {"歌名": "回马枪", "歌手": "张晓棠", "风格": "古风", "备注": ""},
    {"歌名": "壁上观", "歌手": "鞠婧祎", "风格": "古风", "备注": ""},
    {"歌名": "外婆桥", "歌手": "任然", "风格": "民谣", "备注": ""},
    {"歌名": "多情岸", "歌手": "忘川风华录", "风格": "古风", "备注": ""},
    {"歌名": "多情种", "歌手": "徐泽（要不要买菜）", "风格": "流行", "备注": ""},
    {"歌名": "多远都要在一起", "歌手": "G.E.M.邓紫棋", "风格": "流行", "备注": ""},
    {"歌名": "大地飞歌", "歌手": "宋祖英", "风格": "古风", "备注": "民族高音"},
    {"歌名": "天上掉下个林妹妹", "歌手": "黄诗扶", "风格": "古风", "备注": ""},
    {"歌名": "天地龙鳞", "歌手": "王力宏", "风格": "古风", "备注": ""},
    {"歌名": "天堂岛之歌", "歌手": "蕊蕊蕊蕊！", "风格": "古风", "备注": "流行高音"},
    {"歌名": "天策枪魂", "歌手": "肥皂菌丨珉珉的猫咪丨", "风格": "古风", "备注": "古风高音"},
    {"歌名": "天若有情", "歌手": "黄丽玲", "风格": "古风", "备注": ""},
    {"歌名": "太阳", "歌手": "TAEYANG", "风格": "流行", "备注": ""},
    {"歌名": "失恋无罪", "歌手": "黄丽玲", "风格": "古风", "备注": "流行高音"},
    {"歌名": "好想你", "歌手": "朱主爱", "风格": "流行", "备注": ""},
    {"歌名": "好运来", "歌手": "祖海", "风格": "古风", "备注": "民族高音"},
    {"歌名": "好逑", "歌手": "黄龄", "风格": "古风", "备注": ""},
    {"歌名": "如愿", "歌手": "王菲", "风格": "流行", "备注": ""},
    {"歌名": "如故", "歌手": "张碧晨", "风格": "流行", "备注": ""},
    {"歌名": "如果可以", "歌手": "韦礼安", "风格": "古风", "备注": ""},
    {"歌名": "如果突然想起我", "歌手": "喵☆酱", "风格": "古风", "备注": ""},
    {"歌名": "如此", "歌手": "单依纯", "风格": "流行", "备注": ""},
    {"歌名": "娶", "歌手": "苏敬安", "风格": "古风", "备注": ""},
    {"歌名": "孤独颂歌", "歌手": "戴羽彤", "风格": "古风", "备注": ""},
    {"歌名": "孽海记", "歌手": "黄诗扶", "风格": "古风", "备注": ""},
    {"歌名": "寄明月", "歌手": "SING女团", "风格": "流行", "备注": ""},
    {"歌名": "将军令", "歌手": "吴克群", "风格": "古风", "备注": ""},
    {"歌名": "小情歌", "歌手": "苏打绿", "风格": "流行", "备注": ""},
    {"歌名": "小诗句", "歌手": "张碧晨", "风格": "流行", "备注": ""},
    {"歌名": "小雨", "歌手": "黄龄", "风格": "古风", "备注": ""},
    {"歌名": "少女作妖日记", "歌手": "纳豆nado", "风格": "古风", "备注": ""},
    {"歌名": "尘埃", "歌手": "家家", "风格": "流行", "备注": ""},
    {"歌名": "就是哪吒", "歌手": "凑不齐乐队", "风格": "古风", "备注": ""},
    {"歌名": "山上雪", "歌手": "万象凡音", "风格": "古风", "备注": ""},
    {"歌名": "山海入梦来", "歌手": "邹秋实", "风格": "古风", "备注": ""},
    {"歌名": "山鬼", "歌手": "Winky诗", "风格": "古风", "备注": ""},
    {"歌名": "岁岁", "歌手": "任素汐", "风格": "民谣", "备注": ""},
    {"歌名": "左手指月", "歌手": "萨顶顶", "风格": "古风", "备注": "古风高音"},
    {"歌名": "带我走", "歌手": "杨丞琳", "风格": "流行", "备注": ""},
    {"歌名": "干物女", "歌手": "封茗囧菌", "风格": "流行", "备注": ""},
    {"歌名": "年轮", "歌手": "张碧晨", "风格": "流行", "备注": ""},
    {"歌名": "广寒宫", "歌手": "丸子呦", "风格": "古风", "备注": ""},
    {"歌名": "弱水三千", "歌手": "苏熠鸣", "风格": "古风", "备注": ""},
    {"歌名": "当你", "歌手": "林俊杰", "风格": "流行", "备注": ""},
    {"歌名": "彩色复活卷", "歌手": "黄龄", "风格": "古风", "备注": ""},
    {"歌名": "彩虹", "歌手": "TimeZ", "风格": "流行", "备注": ""},
    {"歌名": "彻夜", "歌手": "郑润泽", "风格": "流行", "备注": ""},
    {"歌名": "御龙定乾坤", "歌手": "彭苒蕊", "风格": "古风", "备注": ""},
    {"歌名": "循迹", "歌手": "王子健", "风格": "流行", "备注": ""},
    {"歌名": "心上诗", "歌手": "黄诗扶", "风格": "古风", "备注": ""},
    {"歌名": "心愿便利贴", "歌手": "元若蓝", "风格": "古风", "备注": ""},
    {"歌名": "快活记", "歌手": "黄诗扶", "风格": "古风", "备注": ""},
    {"歌名": "悦神", "歌手": "KBShinya", "风格": "古风", "备注": ""},
    {"歌名": "想你时风起", "歌手": "单依纯", "风格": "流行", "备注": ""},
    {"歌名": "慢冷", "歌手": "李荣浩", "风格": "流行", "备注": ""},
    {"歌名": "我不曾忘记", "歌手": "花玲", "风格": "古风", "备注": ""},
    {"歌名": "我是如此相信", "歌手": "Lih_P小爱", "风格": "流行", "备注": ""},
    {"歌名": "我的世界", "歌手": "Lena Raine", "风格": "古风", "备注": ""},
    {"歌名": "我的美丽", "歌手": "海洋Bo", "风格": "古风", "备注": ""},
    {"歌名": "扶桑树", "歌手": "石淞菱", "风格": "古风", "备注": ""},
    {"歌名": "拆穿", "歌手": "闭文思", "风格": "流行", "备注": ""},
    {"歌名": "拜无忧", "歌手": "萧忆情Alex", "风格": "古风", "备注": ""},
    {"歌名": "指纹", "歌手": "杜宣达", "风格": "流行", "备注": ""},
    {"歌名": "挑兰灯", "歌手": "Aki阿杰", "风格": "古风", "备注": ""},
    {"歌名": "探窗", "歌手": "明月社", "风格": "古风", "备注": ""},
    {"歌名": "搁浅", "歌手": "孙颖 (SunYing)", "风格": "流行", "备注": ""},
    {"歌名": "摘星记", "歌手": "能猫的能", "风格": "古风", "备注": ""},
    {"歌名": "故梦", "歌手": "双笙（陈元汐）", "风格": "古风", "备注": ""},
    {"歌名": "救风尘", "歌手": "瑶卮", "风格": "古风", "备注": ""},
    {"歌名": "敕勒歌", "歌手": "何炫丽", "风格": "民谣", "备注": "民族高音"},
    {"歌名": "新九九八十一", "歌手": "洛天依Official", "风格": "古风", "备注": ""},
    {"歌名": "新贵妃醉酒", "歌手": "沅沅子Yaoao", "风格": "古风", "备注": ""},
    {"歌名": "无人之岛", "歌手": "任然", "风格": "古风", "备注": ""},
    {"歌名": "无人知晓的我", "歌手": "黄丽玲", "风格": "古风", "备注": ""},
    {"歌名": "日不落", "歌手": "蔡依林", "风格": "流行", "备注": ""},
    {"歌名": "时候", "歌手": "苏运莹", "风格": "民谣", "备注": "古风高音"},
    {"歌名": "时差", "歌手": "鹿晗", "风格": "流行", "备注": ""},
    {"歌名": "明月天涯", "歌手": "五音Jw", "风格": "古风", "备注": ""},
    {"歌名": "易燃易爆炸", "歌手": "陈粒", "风格": "流行", "备注": ""},
    {"歌名": "昔言", "歌手": "HITA", "风格": "古风", "备注": ""},
    {"歌名": "星河叹", "歌手": "黄龄", "风格": "古风", "备注": ""},
    {"歌名": "星河散尽故人来", "歌手": "国风堂", "风格": "古风", "备注": ""},
    {"歌名": "星辰变", "歌手": "李常超 (Lao乾妈)", "风格": "古风", "备注": ""},
    {"歌名": "春山横波", "歌手": "黄诗扶", "风格": "古风", "备注": ""},
    {"歌名": "春意红包", "歌手": "毛晓彤", "风格": "流行", "备注": ""},
    {"歌名": "春日呓语", "歌手": "黄诗扶", "风格": "古风", "备注": ""},
    {"歌名": "是妈妈是女儿", "歌手": "黄绮珊", "风格": "古风", "备注": ""},
    {"歌名": "是风动", "歌手": "银临", "风格": "古风", "备注": ""},
    {"歌名": "晚夜微雨问海棠", "歌手": "萧忆情Alex", "风格": "古风", "备注": ""},
    {"歌名": "曹操", "歌手": "林俊杰", "风格": "流行", "备注": ""},
    {"歌名": "最后一页", "歌手": "江语晨", "风格": "古风", "备注": ""},
    {"歌名": "月下", "歌手": "苏运莹", "风格": "民谣", "备注": ""},
    {"歌名": "月光", "歌手": "胡彦斌", "风格": "流行", "备注": ""},
    {"歌名": "月出", "歌手": "双笙（陈元汐）", "风格": "古风", "备注": ""},
    {"歌名": "月牙湾", "歌手": "F.I.R.", "风格": "流行", "备注": ""},
    {"歌名": "有一种悲伤", "歌手": "黄丽玲", "风格": "古风", "备注": ""},
    {"歌名": "有鹿来", "歌手": "黄诗扶", "风格": "古风", "备注": ""},
    {"歌名": "杀伐", "歌手": "NL不分", "风格": "古风", "备注": "古风高音"},
    {"歌名": "栩栩", "歌手": "栩栩", "风格": "流行", "备注": ""},
    {"歌名": "梦回神都", "歌手": "周深", "风格": "古风", "备注": ""},
    {"歌名": "梦回还", "歌手": "呦猫UNEKO", "风格": "古风", "备注": "古风高音"},
    {"歌名": "梦幻诛仙", "歌手": "张碧晨", "风格": "古风", "备注": ""},
    {"歌名": "棠梨煎雪", "歌手": "银临", "风格": "古风", "备注": ""},
    {"歌名": "楚歌起", "歌手": "黄诗扶", "风格": "古风", "备注": ""},
    {"歌名": "欧若拉", "歌手": "张韶涵", "风格": "流行", "备注": ""},
    {"歌名": "母系社会", "歌手": "张惠妹", "风格": "古风", "备注": "流行高音"},
    {"歌名": "永不失联的爱", "歌手": "单依纯", "风格": "流行", "备注": ""},
    {"歌名": "江山雪", "歌手": "小爱的妈", "风格": "古风", "备注": ""},
    {"歌名": "江湖之间", "歌手": "李佩琪", "风格": "古风", "备注": ""},
    {"歌名": "江湖少年", "歌手": "东篱", "风格": "古风", "备注": ""},
    {"歌名": "江湖相忘时", "歌手": "辣酱灬", "风格": "古风", "备注": ""},
    {"歌名": "流光记", "歌手": "银临", "风格": "古风", "备注": ""},
    {"歌名": "海芋恋", "歌手": "萧敬腾", "风格": "流行", "备注": ""},
    {"歌名": "清平误", "歌手": "黄诗扶", "风格": "古风", "备注": ""},
    {"歌名": "清明上河图", "歌手": "李玉刚", "风格": "古风", "备注": ""},
    {"歌名": "清醒记", "歌手": "黄诗扶", "风格": "古风", "备注": ""},
    {"歌名": "烧不尽", "歌手": "惊喧", "风格": "古风", "备注": ""},
    {"歌名": "爱的供养", "歌手": "杨幂", "风格": "古风", "备注": ""},
    {"歌名": "爱的回归线", "歌手": "单依纯", "风格": "流行", "备注": ""},
    {"歌名": "牵丝戏", "歌手": "银临", "风格": "古风", "备注": ""},
    {"歌名": "狐言", "歌手": "河图", "风格": "古风", "备注": ""},
    {"歌名": "献天缘", "歌手": "何中华", "风格": "古风", "备注": ""},
    {"歌名": "玄鸟", "歌手": "CashTrippy", "风格": "古风", "备注": ""},
    {"歌名": "珠玉", "歌手": "单依纯", "风格": "流行", "备注": ""},
    {"歌名": "琴师", "歌手": "音频怪物", "风格": "古风", "备注": ""},
    {"歌名": "琴瑟在御", "歌手": "黄诗扶", "风格": "古风", "备注": ""},
    {"歌名": "生死江湖", "歌手": "李常超 (Lao乾妈)", "风格": "古风", "备注": ""},
    {"歌名": "由此去", "歌手": "黄诗扶", "风格": "古风", "备注": ""},
    {"歌名": "百鬼阴阳抄", "歌手": "西瓜Kune", "风格": "古风", "备注": ""},
    {"歌名": "相思", "歌手": "毛阿敏", "风格": "古风", "备注": ""},
    {"歌名": "眉间雪", "歌手": "HITA", "风格": "古风", "备注": ""},
    {"歌名": "着魔", "歌手": "张杰", "风格": "流行", "备注": ""},
    {"歌名": "瞬", "歌手": "郑润泽", "风格": "流行", "备注": ""},
    {"歌名": "知否知否", "歌手": "郭心雨", "风格": "古风", "备注": ""},
    {"歌名": "知念", "歌手": ".Laom", "风格": "古风", "备注": ""},
    {"歌名": "知我", "歌手": "国风堂", "风格": "古风", "备注": ""},
    {"歌名": "碧海问舟", "歌手": "Assen捷", "风格": "古风", "备注": ""},
    {"歌名": "祖籁", "歌手": "黄诗扶", "风格": "古风", "备注": ""},
    {"歌名": "稻草人的胸膛", "歌手": "王淘沙", "风格": "古风", "备注": ""},
    {"歌名": "空山新雨后", "歌手": "音阙诗听", "风格": "古风", "备注": ""},
    {"歌名": "空空", "歌手": "陈粒", "风格": "流行", "备注": ""},
    {"歌名": "穿林响", "歌手": "陈抒妮", "风格": "古风", "备注": ""},
    {"歌名": "第三十八年夏至", "歌手": "河图", "风格": "古风", "备注": ""},
    {"歌名": "笼", "歌手": "张碧晨", "风格": "流行", "备注": ""},
    {"歌名": "红昭愿", "歌手": "音阙诗听", "风格": "古风", "备注": ""},
    {"歌名": "红白", "歌手": "黄诗扶", "风格": "古风", "备注": ""},
    {"歌名": "红蔷薇白玫瑰", "歌手": "G.E.M.邓紫棋", "风格": "流行", "备注": ""},
    {"歌名": "红颜", "歌手": "胡彦斌", "风格": "流行", "备注": ""},
    {"歌名": "纯妹妹", "歌手": "单依纯", "风格": "流行", "备注": ""},
    {"歌名": "给你一点颜色", "歌手": "谭维维", "风格": "古风", "备注": "流行高音"},
    {"歌名": "胡广生", "歌手": "任素汐", "风格": "民谣", "备注": ""},
    {"歌名": "腐草为萤", "歌手": "银临", "风格": "古风", "备注": ""},
    {"歌名": "舍得", "歌手": "王唯旖", "风格": "流行", "备注": ""},
    {"歌名": "良辰夜", "歌手": "黄诗扶", "风格": "古风", "备注": ""},
    {"歌名": "芊芊", "歌手": "焦小飞", "风格": "流行", "备注": ""},
    {"歌名": "芒种", "歌手": "音阙诗听", "风格": "古风", "备注": ""},
    {"歌名": "花落无痕", "歌手": "狸梦喵", "风格": "古风", "备注": ""},
    {"歌名": "苏公堤", "歌手": "熙云XYUN", "风格": "古风", "备注": ""},
    {"歌名": "苏幕遮", "歌手": "张晓棠", "风格": "古风", "备注": ""},
    {"歌名": "若把你", "歌手": "Kirsty刘瑾睿", "风格": "流行", "备注": ""},
    {"歌名": "若梦", "歌手": "en（王翊恩）", "风格": "古风", "备注": ""},
    {"歌名": "草木不朽", "歌手": "陈亦洺", "风格": "古风", "备注": ""},
    {"歌名": "落了白", "歌手": "蒋雪儿Snow.J", "风格": "古风", "备注": ""},
    {"歌名": "落笔成书", "歌手": "赵滏城", "风格": "古风", "备注": ""},
    {"歌名": "葬花词", "歌手": "黄诗扶", "风格": "古风", "备注": ""},
    {"歌名": "虚拟", "歌手": "陈粒", "风格": "流行", "备注": ""},
    {"歌名": "虞兮叹", "歌手": "闻人听書_", "风格": "古风", "备注": ""},
    {"歌名": "行走的鱼", "歌手": "徐佳莹", "风格": "古风", "备注": ""},
    {"歌名": "诀爱", "歌手": "李荣浩", "风格": "古风", "备注": ""},
    {"歌名": "说好不哭", "歌手": "苏丹丹", "风格": "古风", "备注": ""},
    {"歌名": "请笃信一个梦", "歌手": "周深", "风格": "流行", "备注": ""},
    {"歌名": "诺言", "歌手": "郭有才", "风格": "流行", "备注": ""},
    {"歌名": "谓风", "歌手": "流仙", "风格": "古风", "备注": ""},
    {"歌名": "赤伶", "歌手": "谭晶", "风格": "古风", "备注": ""},
    {"歌名": "越来越好", "歌手": "宋祖英", "风格": "古风", "备注": "民族高音"},
    {"歌名": "踮起脚尖爱", "歌手": "洪佩瑜", "风格": "古风", "备注": ""},
    {"歌名": "转身即心痛", "歌手": "谭维维", "风格": "古风", "备注": ""},
    {"歌名": "轻涟", "歌手": "HOYO-MiX", "风格": "古风", "备注": ""},
    {"歌名": "辞九门回忆", "歌手": "解忧草", "风格": "流行", "备注": ""},
    {"歌名": "追梦赤子心", "歌手": "GALA", "风格": "古风", "备注": ""},
    {"歌名": "野人", "歌手": "孟维来", "风格": "民谣", "备注": ""},
    {"歌名": "野子", "歌手": "苏运莹", "风格": "民谣", "备注": ""},
    {"歌名": "锦鲤抄", "歌手": "银临", "风格": "古风", "备注": ""},
    {"歌名": "长相思", "歌手": "春风十里", "风格": "古风", "备注": ""},
    {"歌名": "问情", "歌手": "陈亦洺", "风格": "古风", "备注": ""},
    {"歌名": "问风", "歌手": "金渔", "风格": "古风", "备注": ""},
    {"歌名": "闻说", "歌手": "HITA", "风格": "古风", "备注": ""},
    {"歌名": "阳山绝", "歌手": "洛天依Official", "风格": "古风", "备注": ""},
    {"歌名": "难却", "歌手": "T3CHN0", "风格": "电子", "备注": ""},
    {"歌名": "难忘今宵", "歌手": "李谷一", "风格": "古风", "备注": "民族高音"},
    {"歌名": "雨后日记", "歌手": "单依纯", "风格": "流行", "备注": ""},
    {"歌名": "雪落在先生肩上", "歌手": "黄诗扶", "风格": "古风", "备注": ""},
    {"歌名": "青玉恋", "歌手": "子衿", "风格": "古风", "备注": ""},
    {"歌名": "青白", "歌手": "银临", "风格": "古风", "备注": ""},
    {"歌名": "风月", "歌手": "黄龄", "风格": "古风", "备注": ""},
    {"歌名": "风花雪雨", "歌手": "林斜阳", "风格": "古风", "备注": ""},
    {"歌名": "马步谣", "歌手": "双笙（陈元汐）", "风格": "古风", "备注": ""},
    {"歌名": "鱼玄机", "歌手": "夏浅沫", "风格": "古风", "备注": ""},
    {"歌名": "鸿门宴", "歌手": "李荣浩", "风格": "古风", "备注": ""},
    {"歌名": "麓海为王", "歌手": "祖娅纳惜", "风格": "古风", "备注": "古风高音"},
    {"歌名": "龙卷风", "歌手": "G.E.M.邓紫棋", "风格": "流行", "备注": ""},
    {"歌名": "华阴老腔一声喊", "歌手": "谭维维", "风格": "流行", "备注": "流行高音"}
        ];

        let genreStats = []; // 风格统计数据

        // 页面加载完成后执行
        document.addEventListener('DOMContentLoaded', function() {
            // 绑定随机按钮事件
            const randomButton = document.getElementById('randomButton');
            if (randomButton) {
                randomButton.addEventListener('click', copyRandomSong);
            }

            // 绑定搜索功能
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('input', function() {
                    clearTimeout(this.timer);
                    this.timer = setTimeout(applyFilters, 300);
                });
            }

            // 绑定风格筛选器
            const genreFilter = document.getElementById('genreFilter');
            if (genreFilter) {
                genreFilter.addEventListener('change', applyFilters);
            }

            // 数据已直接嵌入，不再需要从外部加载
            processSongsAndDisplay();

            // 加载最近点歌记录
            displayRecentSongs();

            // 直播状态检测
            detectLiveStatus();

            // --- 动态效果代码 ---
            // 飘屏下雪动态效果
            function initFloatingEmojis() {
                const emoji = '⛰️'; // 使用您指定的符号
                const baseFrequency = 1000; // 基础生成频率（毫秒）
                const maxFrequencyVariation = 500; // 频率随机变化范围

                setInterval(() => {
                    const float = document.createElement('span');
                    float.className = 'floating-emoji';
                    float.textContent = emoji;

                    // 随机起始X位置
                    float.style.left = `${Math.random() * 100}vw`;

                    // 随机大小
                    float.style.fontSize = `${Math.random() * 15 + 15}px`; // 15px to 30px

                    // 随机动画持续时间 (模拟雪花速度不同)
                    const duration = Math.random() * 10 + 10; // 10s to 20s
                    float.style.animationDuration = `${duration}s`;

                    // 随机延迟 (让雪花不同时开始)
                    float.style.animationDelay = `-${Math.random() * duration}s`; // 负延迟使其看上去随机出现

                    // 随机水平飘动量 (模拟风)
                    const xDrift = (Math.random() - 0.5) * 50; // -25vw to 25vw
                    float.style.setProperty('--x-drift', `${xDrift}vw`);


                    document.body.appendChild(float);

                    // 动画结束后移除元素
                    float.addEventListener('animationend', () => {
                        float.remove();
                    });
                }, baseFrequency + Math.random() * maxFrequencyVariation); // 随机频率生成
            }

            // 调用初始化函数
            initFloatingEmojis();
            // --- 动态效果代码结束 ---
        });

        // 处理歌曲数据并显示
        function processSongsAndDisplay() {
            const loading = document.getElementById('loading');
            const songTable = document.getElementById('songTable');
            const randomButton = document.getElementById('randomButton');
            const searchInput = document.getElementById('searchInput');
            const genreFilter = document.getElementById('genreFilter');

            // 数据已就绪，直接处理
            if (loading) loading.style.display = 'none'; // 隐藏加载提示
            if (songTable) songTable.style.display = 'table';
            if (randomButton) randomButton.disabled = false;
            if (searchInput) searchInput.disabled = false;
            if (genreFilter) genreFilter.disabled = false;

            // 修正和处理数据
            const processedSongs = allSongs.map(song => {
                // 处理歌手：如果有逗号，取第一个
                if (song['歌手'] && song['歌手'].includes(',')) {
                    song['歌手'] = song['歌手'].split(',')[0].trim();
                }

                // 自动修正空值
                if (!song['歌手'] || String(song['歌手']).trim() === '') {
                    song['歌手'] = '未知歌手';
                }

                if (!song['风格'] || String(song['风格']).trim() === '') {
                    song['风格'] = '未知风格';
                }

                // Fix the "极注" typo in the song object
                if (song['极注'] !== undefined) {
                    song['备注'] = song['极注'];
                    delete song['极注'];
                }

                return song;
            });

            // 更新 allSongs 为处理后的数据
            allSongs.splice(0, allSongs.length, ...processedSongs);

            // 生成风格统计
            if (allSongs.length > 0) {
                const genreCount = {};

                allSongs.forEach(song => {
                    const genre = song['风格'] || '未知';
                    genreCount[genre] = (genreCount[genre] || 0) + 1;
                });

                // 转换为数组并排序
                genreStats = Object.keys(genreCount).map(genre => {
                    return { genre, count: genreCount[genre] };
                }).sort((a, b) => b.count - a.count);

                // 保存统计信息到localStorage (首页会用到)
                localStorage.setItem('songStats', JSON.stringify({
                    songCount: allSongs.length,
                    genreStats: genreStats
                }));
            }

            // 填充风格筛选器
            populateGenreFilter();

            // 显示歌曲
            displaySongs(allSongs);

            // 添加行点击事件
            addRowClickEvents();

            // 显示加载成功通知
            showToast('歌单已成功加载!');
        }


        // 显示歌曲表格
        function displaySongs(songs) {
            const tbody = document.querySelector('#songTable tbody');
            if (!tbody) return;

            tbody.innerHTML = '';

            songs.forEach(song => {
                const row = document.createElement('tr');
                // 这里只传递歌名，因为复制的格式现在是“点歌 - 歌名”
                row.setAttribute('data-song-info-name', `${song['歌名'] || ''}`);

                row.innerHTML = `
                    <td>${song['歌名'] || '-'}</td>
                    <td>${song['歌手'] || '-'}</td>
                    <td>${song['风格'] || '-'}</td>
                    <td>${song['备注'] || '-'}</td> `;
                tbody.appendChild(row);
            });
        }

        // 添加行点击事件
        function addRowClickEvents() {
            const rows = document.querySelectorAll('#songTable tbody tr');

            rows.forEach(row => {
                row.addEventListener('click', function(event) {
                    // 获取歌曲名
                    const songName = this.getAttribute('data-song-info-name') || '';

                    if (!songName) return;

                    // 构造复制内容
                    const copyContent = `点歌 - ${songName}`;

                    // 复制到剪贴板
                    copyToClipboard(copyContent);

                    // 添加复制成功动画
                    this.classList.add('copied');
                    setTimeout(() => {
                        this.classList.remove('copied');
                    }, 1500);

                    // 保存到最近点歌
                    saveRecentSong({
                        '歌名': songName,
                        '歌手': '（列表点击）' // 标记为列表点击，不显示原歌手
                    });

                    // 显示提示
                    showToast('已复制 ' + copyContent + ' 到剪贴板请前往直播间点歌');
                });
            });
        }

        // 填充风格筛选器
        function populateGenreFilter() {
            const genreFilter = document.getElementById('genreFilter');
            if (!genreFilter || !genreStats || genreStats.length === 0) return;

            // 清空现有选项（保留"所有风格"）
            genreFilter.innerHTML = '<option value="">所有风格</option>';

            // 添加所有风格选项
            genreStats.forEach(stat => {
                const option = document.createElement('option');
                option.value = stat.genre;
                option.textContent = `${stat.genre} (${stat.count})`;
                genreFilter.appendChild(option);
            });
        }

        // 应用筛选（搜索+风格）
        function applyFilters() {
            const searchInput = document.getElementById('searchInput');
            const genreFilter = document.getElementById('genreFilter');

            const searchText = searchInput ? searchInput.value.trim().toLowerCase() : '';
            const selectedGenre = genreFilter ? genreFilter.value.toLowerCase() : ''; // Convert selected genre to lowercase

            const filteredSongs = allSongs.filter(song => {
                const songName = (song['歌名'] || '').toLowerCase();
                const artist = (song['歌手'] || '').toLowerCase(); // Corrected typo
                const genre = (song['风格'] || '').toLowerCase();
                const remark = (song['备注'] || '').toLowerCase(); // Corrected typo

                // Search matching
                const matchesSearch = searchText === '' ||
                    songName.includes(searchText) ||
                    artist.includes(searchText) ||
                    genre.includes(searchText) ||
                    remark.includes(searchText);

                // Genre matching
                const matchesGenre = selectedGenre === '' ||
                    genre === selectedGenre; // Corrected comparison for genre

                return matchesSearch && matchesGenre;
            });

            displaySongs(filteredSongs);
            addRowClickEvents(); // Re-bind click events
        }

        // 复制随机歌曲到剪贴板并显示提示框
        function copyRandomSong() {
            if (!allSongs || allSongs.length === 0) {
                showToast('歌单为空，无法随机选择', 'error');
                return;
            }

            // 随机选择一首歌
            const randomIndex = Math.floor(Math.random() * allSongs.length);
            const randomSong = allSongs[randomIndex];

            // 构造复制内容
            const songName = randomSong['歌名'] || '未知歌曲';
            const copyContent = `点歌 - ${songName}`;

            // 保存到最近点歌
            saveRecentSong({
                '歌名': songName,
                '歌手': '（随机点歌）' // 标记为随机点歌
            });

            // 复制到剪贴板
            copyToClipboard(copyContent);

            // 显示提示
            showToast('已复制 ' + copyContent + ' 到剪贴板请前往直播间点歌');
        }

        // 通用复制到剪贴板函数
        function copyToClipboard(text) {
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(text).catch(err => {
                    console.error('复制失败:', err);
                    fallbackCopy(text);
                });
            } else {
                fallbackCopy(text);
            }
        }

        // 兼容性复制方法
        function fallbackCopy(text) {
            try {
                const textArea = document.createElement('textarea');
                textArea.value = text;
                textArea.style.position = 'fixed';
                textArea.style.top = '0';
                textArea.style.left = '0';
                textArea.style.opacity = '0';
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();

                const success = document.execCommand('copy');
                document.body.removeChild(textArea);

                if (!success) {
                    throw new Error('复制命令失败');
                }
            } catch (err) {
                console.error('复制失败:', err);
                return false;
            }
            return true;
        }

        // 保存最近点歌记录
        function saveRecentSong(song) {
            if (!song) return;

            let recentSongs = JSON.parse(localStorage.getItem('recentSongs')) || [];

            // 获取当前时间
            const now = new Date();
            const timeString = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;

            // 如果歌曲已存在，移动到最前
            recentSongs = recentSongs.filter(s =>
                s['歌名'] !== song['歌名'] || s['歌手'] !== song['歌手']);

            // 添加到开头（只保存歌名和歌手）
            recentSongs.unshift({
                '歌名': song['歌名'] || '未知歌曲',
                '歌手': song['歌手'] || '未知歌手',
                '时间': timeString
            });

            // 只保留最近5首
            recentSongs = recentSongs.slice(0, 5);

            localStorage.setItem('recentSongs', JSON.stringify(recentSongs));
            displayRecentSongs(recentSongs);
        }

        // 显示最近点歌
        function displayRecentSongs(recentSongs = null) {
            const recentContainer = document.getElementById('recentSongs');
            if (!recentContainer) return;

            let songsToDisplay = recentSongs;

            if (!songsToDisplay) {
                // 如果没有传入数据，从localStorage获取
                songsToDisplay = JSON.parse(localStorage.getItem('recentSongs')) || [];
            }

            recentContainer.innerHTML = '';

            // Update count
            const countElement = document.getElementById('recent-count');
            if (countElement) {
                countElement.textContent = songsToDisplay.length;
            }

            if (songsToDisplay.length === 0) {
                recentContainer.innerHTML = '<p class="text-muted">暂无点歌记录</p>';
                return;
            }

            songsToDisplay.forEach(song => {
                const songCard = document.createElement('div');
                songCard.className = 'recent-song-card';
                songCard.innerHTML = `
                    <div class="recent-song-info">
                        <div class="recent-song-title">${song['歌名']}</div>
                        <div class="recent-song-artist">${song['歌手']}</div>
                        <div class="recent-time">${song['时间'] || ''}</div>
                    </div>
                `;
                recentContainer.appendChild(songCard);
            });
        }

        // 显示提示框
        function showToast(message, type = 'success') {
            // 移除已有提示框
            const existingToasts = document.querySelectorAll('.custom-toast');
            existingToasts.forEach(toast => {
                toast.remove();
            });

            // 创建提示框元素
            const toast = document.createElement('div');
            toast.className = `custom-toast ${type}`;
            toast.textContent = message;

            // 添加到页面顶部
            document.body.appendChild(toast);

            // 强制重绘
            toast.offsetHeight;

            // 显示提示框
            toast.style.opacity = '1';
            toast.style.transform = 'translate(-50%, 0)';

            // 3秒后移除
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translate(-50%, -20px)';

                // 完全移除元素
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.remove();
                    }
                }, 500);
            }, 3000);
        }

        // 直播状态检测
        function detectLiveStatus() {
            const liveStatus = document.getElementById('liveStatus');

            if (!liveStatus) return;

            // 检测直播状态
            const isLive = checkLiveStatus();

            if (isLive) {
                liveStatus.innerHTML = '<i class="bi bi-broadcast-pin"></i> 正在直播';
                liveStatus.classList.add('bg-danger', 'animate-pulse');
                liveStatus.classList.remove('bg-secondary');
            } else {
                liveStatus.innerHTML = '<i class="bi bi-mic-mute"></i> 直播结束';
                liveStatus.classList.remove('bg-danger', 'animate-pulse');
                liveStatus.classList.add('bg-secondary');
            }

            // 每5分钟更新一次状态
            setTimeout(detectLiveStatus, 5 * 60 * 1000);
        }

        // 检测直播状态
        function checkLiveStatus() {
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes();

            // 转换为分钟数
            const currentMinutes = hours * 60 + minutes;

            // 定义直播时间段（14:00-15:00 和 18:00-19:30）
            const livePeriod1 = { start: 14*60, end: 15*60 };
            const livePeriod2 = { start: 18*60, end: 19*60+30 };

            return (currentMinutes >= livePeriod1.start && currentMinutes <= livePeriod1.end) ||
                   (currentMinutes >= livePeriod2.start && currentMinutes <= livePeriod2.end);
        }
    </script>
</body>
</html>
